# Story 3.1: GitHub Issue Feed

Status: ready-for-dev

## Prerequisites

> [!CAUTION]
> **HARD DEPENDENCY**: Story 1.1 must be complete before this story can be implemented.

- [ ] Story 1.1: SSE infrastructure for real-time updates

> [!NOTE]
> **BACKEND WORK**: This story requires modifying `scripts/update_github_issues_snapshot.py` to output JSON and adding a `GET /api/issues` endpoint to Unified API. This can be done as part of Story 0.1 or during this story's implementation.

## Story

As a dashboard user,
I want an in-dashboard list of open issues from all /dev repos,
So that I can see project status without leaving the dashboard.

## Acceptance Criteria

1. **Given** the Issues tab is selected **When** the view loads **Then** it displays a table of open GitHub issues with: title, repo, labels, created date, assignee **And** issues are sorted by most recent activity

2. **Given** issues are loaded **When** user types in the search box **Then** issues filter by title and body content (client-side for cached data) **And** search is debounced (300ms)

3. **Given** user clicks a label chip **When** filter is applied **Then** only issues with that label are shown **And** filter chip appears in active filters area

4. **Given** user clicks repo dropdown **When** repos are listed **Then** user can select one or more repos to filter **And** "All repos" option clears repo filter

5. **Given** keyboard navigation is active **When** user presses Cmd+K **Then** global search opens with "Issues" option **And** user can type to search issues directly

## Tasks / Subtasks

- [ ] Task 1: Create Issue Feed module (AC: #1)
  - [ ] Create `src/features/issues/` directory structure
  - [ ] Create `api/`, `components/`, `hooks/`, `data/`, `tests/` subdirectories

- [ ] Task 2: Create IssueTable component (AC: #1)
  - [ ] Create `src/features/issues/components/IssueTable.tsx`
  - [ ] Columns: title, repo, labels, created date, assignee
  - [ ] Sort by most recent activity
  - [ ] Clickable rows to open issue detail

- [ ] Task 3: Create useIssues hook (AC: #1)
  - [ ] Create `src/features/issues/hooks/useIssues.ts`
  - [ ] Fetch from GitHub issue snapshot (generated by `scripts/update_github_issues_snapshot.py`)
  - [ ] Cache with TanStack Query

- [ ] Task 4: Implement search (AC: #2)
  - [ ] Add search input with debounce (300ms)
  - [ ] Filter by title and body content
  - [ ] Client-side filtering on cached data

- [ ] Task 5: Implement label filtering (AC: #3)
  - [ ] Click label chip to filter
  - [ ] Show active filter chips
  - [ ] Clear individual filters

- [ ] Task 6: Implement repo filtering (AC: #4)
  - [ ] Repo dropdown with multi-select
  - [ ] "All repos" option to clear
  - [ ] Show selected repos in dropdown

- [ ] Task 7: Integrate with global search (AC: #5)
  - [ ] Add "Issues" option to Cmd+K palette
  - [ ] Search issues from command palette
  - [ ] Wire to `src/components/layout/CommandPalette.tsx`

- [ ] Task 8: Create Issues route (AC: all)
  - [ ] Create `src/routes/issues/index.tsx`
  - [ ] Wire to TanStack Router

- [ ] Task 9: Write tests (AC: all)
  - [ ] Test table rendering
  - [ ] Test search filtering
  - [ ] Test label/repo filtering

## Dev Notes

### Architecture Compliance

**Implements FR8**: GitHub Issue Feed

Per `architecture.md`:
- Feature-first: `src/features/issues/`
- Uses GitHub issue snapshot from `scripts/update_github_issues_snapshot.py`
- Integrates with global search (Cmd+K) via cmdk

### Technical Requirements

**Issue Source**:
- Snapshot file generated by `scripts/update_github_issues_snapshot.py`
- Stored in `docs/project-documentation/github-issues.md`
- Run script before starting new planning workflows

**Global Search (Cmd+K)** (from Architecture):
- Use `cmdk` component
- Search scope: Jobs, services, GitHub issues, navigation commands
- Full arrow-key support, Enter to select, Escape to close

### GitHub Issue Data Source

**Existing snapshot script:** `scripts/update_github_issues_snapshot.py`

**Current snapshot format:** Markdown table in `docs/project-documentation/github-issues.md`

| Aspect | Current | Needed for Dashboard |
|--------|---------|---------------------|
| Format | Markdown tables | JSON array |
| Storage | `docs/project-documentation/github-issues.md` | API endpoint |
| Refresh | Manual script run | Manual (same) |

**Recommendation:**
1. Modify `update_github_issues_snapshot.py` to also output JSON: `docs/github-issues.json`
2. Create Unified API endpoint `GET /api/issues` that reads this JSON file
3. Dashboard fetches via TanStack Query with 60-second stale time
4. Real-time sync is NOT required (manual refresh is acceptable)

**Existing script already fetches:**
- Issue number, title, labels, created date, body summary
- Open and recently closed issues
- From GitHub API: `https://api.github.com/repos/{repo}/issues`

### Library/Framework Requirements

- cmdk for command palette
- shadcn/ui Table, Input, Select
- TanStack Query for caching

### File Structure Requirements

```
src/features/issues/
├── api/
│   └── issues.ts              # NEW
├── components/
│   └── IssueTable.tsx         # NEW
├── hooks/
│   └── useIssues.ts           # NEW
└── tests/
    └── issues.test.ts         # NEW

src/routes/issues/
└── index.tsx                  # NEW

src/components/layout/
└── CommandPalette.tsx         # NEW or MODIFY
```

### Dependencies

- **No direct dependencies** on other stories
- Should be implemented after Epic 1 is stable

### References

- [Source: _bmad-output/planning-artifacts/architecture.md#Global Search (Cmd+K)]
- [Source: _bmad-output/planning-artifacts/epics.md#Story 3.1]
- [Source: _bmad-output/planning-artifacts/prd.md#FR8]

## Dev Agent Record

### Agent Model Used

{{agent_model_name_version}}

### Debug Log References

### Completion Notes List

### File List
